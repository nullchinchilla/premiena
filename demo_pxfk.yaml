categories:
  C:
    [
      p,
      t,
      k,
      f,
      s,
      h,
      b,
      d,
      g,
      q,
      x,
      r,
      l,
      w,
      y,
      n,
      m,
      ñ,
      j,
      v,
      š,
      ž,
      č,
      z,
      c,
      "'",
      þ,
      ð,
    ]
  V: [a, e, i, o, u, ē, ō, ë, ī, ū, ï, 1]
  M: [i, u]
  XT: [n, t, d, z, c]
  XPREPAT: [t, k, d, g, l, m, n]
  XPOSTPAT: [q, q, j, j, y, y, y]

  XPREFLAT: [k, g, l, m, n, h]
  XPOSTFLAT: [p, b, w, w, w, f]

  XYER: [i, ë, u]
  # XNONYER: [a, u, ē, ō, o, e]
  # XWEAK: [è, à, ]
  # XSTRONG: [i, a]

rules:
  # some respelling
  - ng > ñ / _
  - zh > ž / _
  - sh > š / _
  - ch > č / _
  - ui > uei / _
  - un > uën / _
  - iñ > iëñ / _
  - ye > yie / _
  - yang > iañ / _
  - mo > muo / _
  - po > puo / _
  - bo > buo / _
  - wo > wë / _
  - jia > ja / _
  - xia > xa / _

  # "rendaku"
  - C' > CC / _

  # remove the problematic RRR sounds
  - i > ë / (š|č|ž|s|z|c)_

  # make /o/ /e/ /ë/ distinction phonemic
  - e > ë / (%|C|')_(%|C|')
  - ai > ē / (%|C|')_
  - ei > e / (%|C|')(M|)_
  - ao > ō / (%|C|')_
  - ou > o / (%|C|')_
  - añ > on / (%|C|')(u|i)_
  - ëñ > ën / _
  - oñ > un / _

  # remove the <w> medial
  - yue > we / _
  - uan > en / (j|q|x|y)_
  - u > ui / (j|q|x|y)_(%|C|')
  - ü > ui / _
  - XPREFLATu > XPOSTFLAT / _V
  - u >  / _V

  # remove the <i> medial in various ways
  - ian > en / _(%|C|')
  - iao > ō / _
  - ing > en / _
  - ie > e / _
  - ia > ē / (%|C|')_(%|C|')
  - iu > io / _
  - XPREPAT > XPOSTPAT / _(iV)
  - š > x / _
  - ž > j / _
  - č > q / _
  - i > / (%|C|')_V

  # foot-based syncope of all schwas, and all high vowels before voiceless sounds or affricates
  - ë > 1 / %(C*VC*V)*(C*VC*)_
  - (i|u) > 1 / %(C*VC*V)*(C*VC*)_(p|t|k|f|s|h|q|x)
  - 1 > / _
  - y > i / C_(C|%)
  - y > / _i
  - n > un / C_(C|%)

  # remove final schwa
  - ë > / _%
  - ë > a / _

  # # get rid of the stupid <r> sound
  - r > y / _

  # great consonant shift:
  # - j becomes r
  # - then, j > z and q > c, pushing z to ð and c to þ. there is no more postalveolars.
  - j > s / n_
  - j > r / _
  - z > ð / _
  - c > þ / _

  - r > n / %_

  # remove c
  - q > ts / V_V
  - q > s / _

  # assimilation
  - (n|l) > r / _r
  - ds > z / _
  - dz > z / _

  # generate falling diphthongs by removing g
  - g > y / V_V
  - g > i / _

  # non-initial vowel shift
  - o > ō / _n(C|%)
  - o > u / VC*_
  - ō > o / VC*_
  - e > ē / _n(C|%)
  - e > i / VC*_
  - ē > e / VC*_

  # a different vowel shift for the first vowel
  - e > ie / %C*_C
  - ē > e / %C*_
  - o > uo / %C*_C
  - ō > o / %C*_

  # spelling changes
  - w > v / _
